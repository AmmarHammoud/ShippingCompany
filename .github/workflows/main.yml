name: ğŸš€ Deploy Laravel to SmarterASP

on:
  push:
    branches:
      - main  

jobs:
  web-deploy:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸšš Get latest code
      uses: actions/checkout@v4

    - name: ğŸ›  Install PHP dependencies
      run: composer install --no-dev --optimize-autoloader

    - name: âš¡ Cache Laravel
      run: |
        php artisan config:cache
        php artisan route:cache
        php artisan view:cache

    # â¬†ï¸ Ø§Ø±ÙØ¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Ø¨Ø¯ÙˆÙ† public) Ø®Ø§Ø±Ø¬ wwwroot
    - name: ğŸ“‚ Upload core Laravel files
      uses: SamKirkland/FTP-Deploy-Action@v4.3.6
      with:
        server: win8117.site4now.net
        username: fastship-001
        password: ${{ secrets.PASSWORD }}
        local-dir: ./
        server-dir: www/shipping-company/
        exclude: |
          **/public/**
          **/node_modules/**
          **/.git/**
          **/.github/**
          **/.env
          **/tests/**

    # â¬†ï¸ Ø§Ø±ÙØ¹ public ÙÙ‚Ø· Ø¹Ù„Ù‰ wwwroot
    - name: ğŸ“‚ Upload public folder
      uses: SamKirkland/FTP-Deploy-Action@v4.3.6
      with:
        server: win8117.site4now.net
        username: fastship-001
        password: ${{ secrets.PASSWORD }}
        local-dir: ./public
        server-dir: wwwroot/
